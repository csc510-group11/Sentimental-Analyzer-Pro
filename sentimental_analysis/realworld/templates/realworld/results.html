{% extends 'realworld/base.html' %}

{% block title %}Analysis Result - Sentiment Analyzer Pro{% endblock %}

{% block content %}
<div class="container my-5">
  <!-- Page Header -->
  <div class="text-center mb-5">
    <h1 class="display-4">Analysis Result</h1>
    <p class="lead">Here are the insights from your text analysis.</p>
  </div>

  <!-- Analyzed Text Section -->
  <div class="row mb-5">
    <div class="col-12">
      <div class="card border-0 shadow-lg">
        <div class="card-header bg-primary text-white">
          <strong>Analyzed Text</strong>
        </div>
        <div class="card-body">
          <textarea class="form-control" rows="5" readonly>{{ text }}</textarea>
        </div>
      </div>
    </div>
  </div>

  <!-- Sentiment Charts Section -->
  <div class="row">
    <!-- Doughnut Chart for Sentiment Distribution -->
    <div class="col-md-6 mb-4">
      <div class="card border-0 shadow-lg">
        <div class="card-header bg-success text-white">
          <strong>Sentiment Distribution</strong>
        </div>
        <div class="card-body">
          <div id="distributionChart" style="height: 300px; width: 100%;"></div>
        </div>
      </div>
    </div>
    <!-- Column Chart for Sentiment Graph -->
    <div class="col-md-6 mb-4">
      <div class="card border-0 shadow-lg">
        <div class="card-header bg-info text-white">
          <strong>Sentiment Graph</strong>
        </div>
        <div class="card-body">
          <div id="graphChart" style="height: 300px; width: 100%;"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Navigation -->
  <div class="text-center">
    <a href="{% url 'index' %}" class="btn btn-outline-secondary">Back to Home</a>
  </div>
</div>
{% endblock %}

{% block extra_scripts %}
<!-- CanvasJS Library -->
<script src="https://canvasjs.com/assets/script/canvasjs.min.js"></script>
<script>
  window.onload = function () {
    // Create the Doughnut Chart for Sentiment Distribution
    var distributionChart = new CanvasJS.Chart("distributionChart", {
      animationEnabled: true,
      theme: "light2",
      title: { text: "Sentiment Distribution" },
      data: [{
        type: "doughnut",
        indexLabel: "{label}: {y}%",
        dataPoints: [
          { y: ({{ sentiment.pos }} * 100), label: "Positive" },
          { y: ({{ sentiment.neu }} * 100), label: "Neutral" },
          { y: ({{ sentiment.neg }} * 100), label: "Negative" }
        ]
      }]
    });
    distributionChart.render();
    
    // Create the Column Chart for Sentiment Graph
    var graphChart = new CanvasJS.Chart("graphChart", {
      animationEnabled: true,
      theme: "light2",
      title: { text: "Sentiment Graph" },
      axisY: { title: "Sentiment (%)" },
      data: [{
        type: "column",
        dataPoints: [
          { label: "Positive", y: ({{ sentiment.pos }} * 100) },
          { label: "Neutral", y: ({{ sentiment.neu }} * 100) },
          { label: "Negative", y: ({{ sentiment.neg }} * 100) }
        ]
      }]
    });
    graphChart.render();
  };
</script>
{% endblock %}
